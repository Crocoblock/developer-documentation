# Booking Cancellation

Функціонал скасування бронювання дозволяє користувачам скасовувати бронювання запланованої активності. Функція скасування
бронювання має на меті надати користувачам гнучкість в управлінні своїми бронюваннями, а також забезпечити прозорість і 
справедливість процесу скасування як для користувачів, так і для постачальників послуг.

Функціональність скасування бронювання не працює за замовченням і потребує активації. Для її активації треба перейти до 
налаштувань бронювань у вкладку розширених налаштувань: **Bookings** -> **Settings** -> **Advanced**.

![Booking Cancellation Settings](/06-jet-booking/03-features/02-booking-cancellation/assets/booking-cancellation-settings.png "Налаштування скасувань бронювань")

На сторінці розширених налаштувань присутні дві опції налаштування скасування. Перша `Booking cancellation` це основна та
головна опція яка відповідає за увімкнення функціональності скасування. Також додатково ця опція відповідає за відображення 
наступної опції.

`Cancellation deadline` - опція що відповідає за певний період часу до дати початку бронювання, протягом якого користувачі 
можуть скасувати своє бронювання. Цей функціональність часто визначається постачальником послуг і може змінюватися залежно 
від характеру бронювання. Також ця опція буде відображена і буде працювати лише якщо увімкнуто `Booking cancellation`.

Контрол опції `Cancellation deadline` розбитий на дві частини, де в першому полі треба обрати кількість, а в другому полі значення
відповідно яких будуть проводитися розрахунки. Мінімальна кількість яку можна обрати 1.

> На зображені вище показано робоче налаштування, де користувачу дозволено скачувати бронювання за тиждень до дати початку бронювання.

Стосовно самого процесу скасування, то його реалізовано за допомогою спеціального посилання, яке містить відповідні параметри, які 
відповідають за отримання пов'язаного бронювання та його подальшої модифікації.

Самі посилання на скасування бронювання можна отримати в декілька способів.

Перший спосіб можливий лише за умови якщо у вас на сайті активовано плагін WooCommerce. Більше про це можна дізнатись за
[посиланням](/06-jet-booking/03-features/01-booking-list-in-wc-my-account-page). За цих умов та умов налаштування скасування
в спеціальному ендпоінті бронювання будуть показані списки бронювань клієнтів, якщо бронювання може бути скасованим, в останній 
колонці буде доступна кнопка скасування.

Після натискання на кнопку скасування, з'явиться вікно підтвердження скасування, воно слугує для того щоб клієнти випадково 
не скасував своє бронювання, тому що після цього треба буде створювати бронювання з самого початку, чи зв'язуватись з адміністраторами 
сервісу для відновлення бронювання без можливості подальшого скасування.

![Booking Cancellation Confirmation Window](/06-jet-booking/03-features/02-booking-cancellation/assets/booking-cancel-confirmation.png "Вікно підтвердження відміни бронювання")

По підтвердженню скасування користувача буде перенаправлено на початкову сторінку акаутна, а також виведено повідомлення
про статус виконаної операції. На разі існує лише два статуси, або виникла помилка, буде виведено про це повідомлення, а 
саме бронювання не буде скасовано, а також повідомлення про успішне скасування, відповідно бронювання яке було скасоване набуде нового 
статусу.

![Booking Cancellation WoCommerce Notice](/06-jet-booking/03-features/02-booking-cancellation/assets/booking-cancel-notice.png "Повідомлення після скасування")

Всі відповідні зміни будуть зображені в ендпоінті зі списком бронювань.

Другий спосіб отримання посилання для скасування бронювань реалізований за допомогою віджету Dynamic Link плагіну JetEngine,
тож для використання цієї функціональності необхідно буде встановити плагін JetEngine.

![Booking Cancellation with Dynamic Link Widget](/06-jet-booking/03-features/02-booking-cancellation/assets/dynamic-link-widget-cancel-source.png "Скасування бронювань за допомогою динамічного посилання")

В контролі налаштування джерела посилання, в групі JetBooking представлено відповідну опцію для скасування. При виборі цієї опції
буде також зображено додатковий контрол для налаштування адреси перенаправлення після скасування бронювання. В цей контрол можна
наприклад вставити посилання на сторінку зроблену спеціально для скасування бронювання на якій буде повідомлення про це. За
замовчуванням перенаправлення буде виконано на домашню сторінку сайту, також можна скористатись макросами для отримання посилання 
перенаправлення.

> Динамічне посилання дял скасування бронювання буде працювати лише в лістингу який створений за допомогою кастомного запиту
> JetBooking Query.
 
Віджет з посиланням на скасування буде виводитись у всіх елементах лістингу, в елементах де скасування не можливе посилання будуть вести
на поточну сторінку де виводиться лістинг. Для попередження такого процесу, та усунення цього недоліку було реалізовано динамічну умову,
яка перевіряє можливість скасування бронювання та у випадку такої можливості буде виводити елемент на який повішано умову.

![Booking Cancellation Dynamic Visibility](/06-jet-booking/03-features/02-booking-cancellation/assets/dynamic-visibility-for-booking-cancellation.png "Умова відображення для скасування бронювань")

Сам процес скасування відбувається таким самим чином як і на сторінці акаута. Тобто буде виведено вікно підтвердження і
лише після підтвердження, буде запущено сам процес скасування.

> Повідомлення як у випадку з WooCommerce акаунтом можуть не зображатись, це буде залежати від активності плагіну WooCommerce
> та перенаправлення після скасування на сторінку пов'язану з плагіном WooCommerce.

> Другий спосіб отримання посилання для скасування бронювання та налаштування динамічних умов попри демонстрацію в редакторі 
> Elementor може бути реалізовано, як за допомогою Gutenberg так і з допомогою Bricks.